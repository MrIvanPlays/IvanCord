From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Ivan Pekov <ivan@mrivanplays.com>
Date: Mon, 15 Nov 2021 08:05:06 +0200
Subject: [PATCH] Add isLegacy to ProxyPingEvent


diff --git a/api/src/main/java/net/md_5/bungee/api/event/ProxyPingEvent.java b/api/src/main/java/net/md_5/bungee/api/event/ProxyPingEvent.java
index ddee993a41a56425897e50c3664341e932ef7a64..562b1f34a8a0a0cf7f5a84f78bf0bfd8a2952f05 100644
--- a/api/src/main/java/net/md_5/bungee/api/event/ProxyPingEvent.java
+++ b/api/src/main/java/net/md_5/bungee/api/event/ProxyPingEvent.java
@@ -25,10 +25,25 @@ public class ProxyPingEvent extends AsyncEvent<ProxyPingEvent>
      */
     private ServerPing response;
 
+    // IvanCord start
+    /**
+     * Whether this event was called for a legacy ping
+     */
+    private final boolean legacy;
+    // IvanCord end
+
     public ProxyPingEvent(PendingConnection connection, ServerPing response, Callback<ProxyPingEvent> done)
+    // IvanCord start
+    {
+        this( connection, response, false, done );
+    }
+
+    public ProxyPingEvent(PendingConnection connection, ServerPing response, boolean legacy, Callback<ProxyPingEvent> done)
+    // IvanCord end
     {
         super( done );
         this.connection = connection;
         this.response = response;
+        this.legacy = legacy; // IvanCord
     }
 }
diff --git a/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java b/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
index 618fabf947047187becfcc3c251299f563f43516..2c217d3c1aeccdb0ea22144e916c8589a7b683f5 100644
--- a/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
+++ b/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
@@ -233,7 +233,7 @@ public class InitialHandler extends PacketHandler implements PendingConnection
                     }
                 };
 
-                bungee.getPluginManager().callEvent( new ProxyPingEvent( InitialHandler.this, result, callback ) );
+                bungee.getPluginManager().callEvent( new ProxyPingEvent( InitialHandler.this, result, legacy, callback ) ); // IvanCord
             }
         };
 
